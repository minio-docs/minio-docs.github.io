

<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Server-Side Encryption with Per-Bucket Keys (SSE-KMS) &#8212; MinIO Object Storage (AGPLv3)</title>
    <link rel="stylesheet" type="text/css" href="../../static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.css" />
    <link rel="stylesheet" type="text/css" href="../../static/css/main.min.css" />
    <link rel="stylesheet" type="text/css" href="../../static/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../static/documentation_options.js"></script>
    <script src="../../static/doctools.js"></script>
    <script src="../../static/sphinx_highlight.js"></script>
    <script src="../../static/clipboard.min.js"></script>
    <script src="../../static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../static/design-tabs.js"></script>
    <script src="../../static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js"></script>
    <script src="../../static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/instantsearch.js@4"></script>
    <script defer="defer" src="../../static/js/main.js"></script>
    <script defer="defer" src="../../static/js/instantSearch.js"></script>
    <link rel="canonical" href="https://docs.min.io/community/minio-object-store/administration/server-side-encryption/server-side-encryption-sse-kms.html" />
    <link rel="icon" href="../../static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Server-Side Encryption Per-Deployment Key (SSE-S3)" href="server-side-encryption-sse-s3.html" />
    <link rel="prev" title="Server-Side Encryption of Objects" href="../server-side-encryption.html" /><meta name="pagename" content="administration/server-side-encryption/server-side-encryption-sse-kms"/>

<!-- Preload fonts and scripts -->
<link rel="preload" href="../../static/fonts/inter/Inter-Regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="../../static/fonts/inter/Inter-Medium.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="../../static/fonts/inter/Inter-Bold.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preconnect" href="https://E1CSOK3UC2-dsn.algolia.net" crossorigin />

<!-- Google Tag Manager: docs.min.io -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-56L9FLVL');</script>

<!-- Google Tag Manager: main -->
<script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TWQNHTD');
</script>

<!-- Google Analytics -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-56860620-1', 'auto');
    ga('send', 'pageview');
</script>

<!-- Linkedin -->
<script>
    _linkedin_partner_id = "1153348";
    window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
    window._linkedin_data_partner_ids.push(_linkedin_partner_id);

    (function(l) {
    if (!l){window.lintrk = function(a,b){window.lintrk.q.push([a,b])};
    window.lintrk.q=[]}
    var s = document.getElementsByTagName("script")[0];
    var b = document.createElement("script");
    b.type = "text/javascript";b.async = true;
    b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
    s.parentNode.insertBefore(b, s);})(window.lintrk);
</script>

<!-- Leadfeeder -->
<script>
    (function(){
        window.ldfdr = window.ldfdr || {};
        (function(d, s, ss, fs){
        fs = d.getElementsByTagName(s)[0];
        function ce(src){
            var cs  = d.createElement(s);
            cs.src = src;
            setTimeout(function(){fs.parentNode.insertBefore(cs,fs)}, 1);
        }
        ce(ss);
        })(document, 'script', 'https://sc.lfeeder.com/lftracker_v1_DzLR5a5kKJA7BoQ2.js');
    })();
</script>
   
   
  <link rel="stylesheet" href="../../static/custom.css" type="text/css" />
  

  
  


  </head><body><!-- Google Tag Manager: docs.min.io (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-56L9FLVL" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><header class="header inactive">
   <div class="container">
      <div class="header__inner">
         <a href="https://min.io?jmp=docs-minio-object-store" class="header__logo">
            <svg viewBox="0 0 162.612 24.465">
               <path d="M52.751.414h9.108v23.63h-9.108zM41.711.74l-18.488 9.92a.919.919 0 0 1-.856 0L3.879.74A2.808 2.808 0 0 0 2.558.414h-.023A2.4 2.4 0 0 0 0 2.641v21.376h9.1V13.842a.918.918 0 0 1 1.385-.682l10.361 5.568a3.634 3.634 0 0 0 3.336.028l10.933-5.634a.917.917 0 0 1 1.371.69v10.205h9.1V2.641A2.4 2.4 0 0 0 43.055.414h-.023a2.808 2.808 0 0 0-1.321.326zm65.564-.326h-9.237v10.755a.913.913 0 0 1-1.338.706L72.762.675a2.824 2.824 0 0 0-1.191-.261h-.016a2.4 2.4 0 0 0-2.535 2.227v21.377h9.163V13.275a.914.914 0 0 1 1.337-.707l24.032 11.2a2.813 2.813 0 0 0 1.188.26 2.4 2.4 0 0 0 2.535-2.227zm7.161 23.63V.414h4.191v23.63zm28.856.421c-11.274 0-19.272-4.7-19.272-12.232C124.02 4.741 132.066 0 143.292 0s19.32 4.7 19.32 12.233-7.902 12.232-19.32 12.232zm0-21.333c-8.383 0-14.84 3.217-14.84 9.1 0 5.926 6.457 9.1 14.84 9.1s14.887-3.174 14.887-9.1c0-5.883-6.504-9.1-14.887-9.1z" />
            </svg>
         </a>
         
         <!--
         <div class="header__actions">
            

            <button id="dark-mode-toggle" type="button" class="icon icon--switch"><svg width="21" height="21" viewBox="0 0 48 48" fill="currentColor">
    <path d="M24 42q-7.5 0-12.75-5.25T6 24q0-6.75 3.975-11.45Q13.95 7.85 20.4 6.5q2.05-.4 2.8.7t-.05 3q-.45 1.15-.7 2.35-.25 1.2-.25 2.45 0 4.5 3.15 7.65Q28.5 25.8 33 25.8q1.25 0 2.425-.225 1.175-.225 2.275-.625 2.15-.8 3.2.075 1.05.875.55 2.975-1.35 6.05-6.05 10.025Q30.7 42 24 42Zm0-3q5.45 0 9.5-3.375t5.05-7.925q-1.25.55-2.675.825Q34.45 28.8 33 28.8q-5.75 0-9.775-4.025T19.2 15q0-1.2.25-2.575.25-1.375.9-3.125-4.9 1.35-8.125 5.475Q9 18.9 9 24q0 6.25 4.375 10.625T24 39Zm-.2-14.85Z" />
</svg><svg width="17" height="17" viewBox="0 0 17 17">
    <path d="M8.5 2.898c-.167 0-.306-.055-.415-.164s-.164-.248-.164-.415V.58c0-.167.055-.306.164-.415S8.333 0 8.5 0s.306.055.415.164.164.248.164.415v1.739c0 .167-.055.306-.164.415s-.248.164-.415.164zm3.96 1.642c-.116-.116-.174-.251-.174-.406s.058-.29.174-.406l1.217-1.236c.116-.116.254-.174.415-.174s.299.058.415.174.174.251.174.406-.058.29-.174.406L13.272 4.54c-.116.116-.251.174-.406.174s-.29-.058-.406-.174zm2.222 4.54c-.167 0-.306-.055-.415-.164s-.164-.248-.164-.415.055-.306.164-.415.248-.164.415-.164h1.739c.167 0 .306.055.415.164S17 8.333 17 8.5s-.055.306-.164.415-.248.164-.415.164h-1.739zM8.5 17c-.167 0-.306-.055-.415-.164s-.164-.248-.164-.415v-1.739c0-.167.055-.306.164-.415s.248-.164.415-.164.306.055.415.164.164.248.164.415v1.739c0 .167-.055.306-.164.415S8.667 17 8.5 17zM3.728 4.54L2.492 3.323c-.116-.116-.174-.254-.174-.415s.058-.299.174-.415.251-.174.406-.174.29.058.406.174L4.54 3.728c.116.116.174.251.174.406s-.058.29-.174.406c-.116.103-.254.155-.415.155s-.293-.052-.396-.155zm9.968 9.968l-1.236-1.236c-.116-.116-.174-.251-.174-.406s.058-.29.174-.406c.103-.103.235-.155.396-.155s.299.052.415.155l1.256 1.217c.116.116.171.254.164.415s-.061.299-.164.415c-.116.116-.254.174-.415.174s-.299-.058-.415-.174h0zM.58 9.08c-.167 0-.306-.055-.415-.164S0 8.667 0 8.5s.055-.306.164-.415.248-.164.415-.164h1.739c.167 0 .306.055.415.164s.164.248.164.415-.055.306-.164.415-.248.164-.415.164H.58zm1.912 5.428c-.116-.116-.174-.251-.174-.406s.058-.29.174-.406l1.236-1.236c.103-.103.235-.155.396-.155s.299.052.415.155c.116.116.174.254.174.415s-.058.299-.174.415l-1.217 1.217c-.116.116-.254.174-.415.174s-.299-.058-.415-.174h0zM8.5 13.136a4.47 4.47 0 0 1-3.284-1.352A4.47 4.47 0 0 1 3.864 8.5a4.47 4.47 0 0 1 1.352-3.284A4.47 4.47 0 0 1 8.5 3.864a4.47 4.47 0 0 1 3.284 1.352A4.47 4.47 0 0 1 13.136 8.5a4.47 4.47 0 0 1-1.352 3.284A4.47 4.47 0 0 1 8.5 13.136zm0-1.159a3.35 3.35 0 0 0 2.463-1.014A3.35 3.35 0 0 0 11.977 8.5a3.35 3.35 0 0 0-1.014-2.463A3.35 3.35 0 0 0 8.5 5.023a3.35 3.35 0 0 0-2.463 1.014A3.35 3.35 0 0 0 5.023 8.5a3.35 3.35 0 0 0 1.014 2.463A3.35 3.35 0 0 0 8.5 11.977z" fill="currentColor" />
</svg>
               Dark Mode
            </button>
         </div>
         -->
      </div>
  
      <h2 class="header__title hidden-rm">Documentation</h2>

      

      <!--<div class="platform-nav">
    <div class="platform-nav__main">
        <div class="container">
        </div>
        <button type="button" class="icon search-toggle search-toggle--keyboard visible-rm"><svg width="14" height="15">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 6.5a5 5 0 1 1-10 0 5 5 0 0 1 10 0Zm-1.59 5.535a6.5 6.5 0 1 1 1.179-.931l1.845 2.096a.75.75 0 0 1-1.127.99L9.91 12.036Z"/>
</svg>
            Search
        </button>
    </div>
</div> -->
         <div id="search">
            <div class="search__inner">
               <div id="search-box"></div>
               
               <div class="search__dropdown">
                  <div id="search-filters"></div>
                  <div id="search-clear"></div>
                  <div id="search-results"></div>
                  <div id="search-powered-by"></div>
               </div>
            </div>
         </div>
   </div>
 </header>
   <section class="content">
      <div class="container">
         <div class="sidebar inactive scrollbar">
            <div class="hide-aside visible-rm">
               <button type="button" class="icon"><svg width="12" height="12">
    <path d="M11.253 1.691L10.125.563 5.653 5.035 1.181.563.053 1.691l4.472 4.472-4.472 4.472 1.128 1.128 4.472-4.472 4.472 4.472 1.128-1.128-4.472-4.472z" fill-rule="evenodd"/>
</svg>
                     Close Doc Navigation
               </button>
            </div>

            <a class="sidebar__title" href="../../index.html">MinIO Object Storage</a>
            
            
      <nav
         class="docs"
         role="navigation"
      >
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../operations/deployments/installation.html">Installation and Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/replication/multi-site-replication.html">Site Replication Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/concepts.html">Core Operational Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/monitoring.html">Monitoring and Alerts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/external-iam.html">External Identity Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/server-side-encryption.html">Data Encryption (SSE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/network-encryption.html">Network Encryption (TLS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/checklists.html">Deployment Checklists</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/data-recovery.html">Recover after Hardware Failure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../minio-console.html">MinIO Console</a></li>
<li class="toctree-l1"><a class="reference internal" href="../object-management.html">Object Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring.html">Monitoring Bucket and Object Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../identity-access-management.html">Identity and Access Management</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../server-side-encryption.html">Server-Side Encryption of Objects</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Server-Side Encryption with Per-Bucket Keys (SSE-KMS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-side-encryption-sse-s3.html">Server-Side Encryption Per-Deployment Key (SSE-S3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-side-encryption-sse-c.html">Server-Side Encryption with Client-Managed Keys (SSE-C)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bucket-replication.html">Bucket Replication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../batch-framework.html">Batch Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts.html">Core Administration Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers/minio-drivers.html">Software Development Kits (SDK)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers/security-token-service.html">Security Token Service (STS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers/transforms-with-object-lambda.html">Transforms with Object Lambda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers/file-transfer-protocol.html">File Transfer Protocol (FTP/SFTP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/kubernetes.html">Kubernetes Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/baremetal.html">Baremetal Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/s3-api-compatibility.html">S3 API Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../integrations/integrations.html">Integrations</a></li>
</ul>

      </nav>
         </div><div class="content__toc scrollbar scrollbar--hover">
  	<button data-aside-toggle="doc" class="icon" type="button"><svg width="17" height="13" viewbox="0 0 17 13">
    <path d="M16.034 0H.966C.433 0 0 .346 0 .773s.433.773.966.773h15.068c.533 0 .966-.346.966-.773S16.567 0 16.034 0zm0 5.409H.966c-.533 0-.966.346-.966.773s.433.773.966.773h15.068c.533 0 .966-.346.966-.773s-.433-.773-.966-.773zm0 5.409H.966c-.533 0-.966.346-.966.773s.433.773.966.773h15.068c.533 0 .966-.346.966-.773s-.433-.773-.966-.773z" />
</svg> TOC Menu
  	</button>

  	<div id="content-toc"></div>
		<button class="icon search-toggle" type="button"><svg width="14" height="15">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 6.5a5 5 0 1 1-10 0 5 5 0 0 1 10 0Zm-1.59 5.535a6.5 6.5 0 1 1 1.179-.931l1.845 2.096a.75.75 0 0 1-1.127.99L9.91 12.036Z"/>
</svg> Search
		</button>
</div>

         <div class="content__main">
            <div class="content__body">
               
  <section id="server-side-encryption-with-per-bucket-keys-sse-kms">
<span id="minio-encryption-sse-kms"></span><h1>Server-Side Encryption with Per-Bucket Keys (SSE-KMS)<a class="headerlink" href="#server-side-encryption-with-per-bucket-keys-sse-kms" title="Permalink to this heading"></a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#quickstart" id="id1">Quickstart</a></p></li>
<li><p><a class="reference internal" href="#secure-erasure-and-locking" id="id2">Secure Erasure and Locking</a></p></li>
<li><p><a class="reference internal" href="#encryption-process" id="id3">Encryption Process</a></p></li>
</ul>
</nav>
<p>MinIO Server-Side Encryption (SSE) protects objects as part of write operations, allowing clients to take advantage of server processing power to secure objects at the storage layer (encryption-at-rest).
SSE also provides key functionality to regulatory and compliance requirements around secure locking and erasure.</p>
<p>MinIO SSE uses the <a class="reference external" href="https://docs.min.io/community/minio-kes/">MinIO Key Encryption Service (KES)</a> and a <a class="reference external" href="https://docs.min.io/community/minio-kes/#supported-kms-targets">supported external Key Management Service (KMS)</a> for performing secured cryptographic operations at scale.
MinIO also supports client-managed key management, where the application takes full responsibility for creating and managing encryption keys for use with MinIO SSE.</p>
<p>MinIO SSE-KMS encrypts or decrypts objects using an External Key (EK) managed by a Key Management System (KMS).
Each bucket and object can have a separate <abbr title="External Key">EK</abbr>, supporting more granular cryptographic operations in the deployment.
MinIO can only decrypt an object if it can access both the KMS <em>and</em> the <abbr title="External Key">EK</abbr> used to encrypt that object.</p>
<p>You can enable bucket-default SSE-KMS encryption using the <a class="reference internal" href="../../reference/minio-mc/mc-encrypt-set.html#command-mc.encrypt.set" title="mc.encrypt.set"><code class="xref minio minio-mc docutils literal notranslate"><span class="pre">mc</span> <span class="pre">encrypt</span> <span class="pre">set</span></code></a> command:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>mc<span class="w"> </span>encrypt<span class="w"> </span><span class="nb">set</span><span class="w"> </span>sse-kms<span class="w"> </span>EXTERNALKEY<span class="w"> </span>play/mybucket
</pre></div>
</div>
<ul class="simple">
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">EXTERNALKEY</span></code> with the name of the <abbr title="External Key">EK</abbr> to use for encrypting
objects in the bucket.</p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">play/mybucket</span></code> with the <a class="reference internal" href="../../reference/minio-mc/mc-alias.html#command-mc.alias" title="mc.alias"><code class="xref minio minio-mc docutils literal notranslate"><span class="pre">alias</span></code></a> and bucket
on which you want to enable automatic SSE-KMS encryption.</p></li>
</ul>
<p>MinIO SSE-KMS is functionally compatible with AWS S3 <a class="reference external" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html">Server-Side Encryption with KMS keys stored in AWS</a> while expanding support to include the following KMS providers:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.min.io/community/minio-kes/integrations/aws-secrets-manager/">AWS Secrets Manager</a></p></li>
<li><p><a class="reference external" href="https://docs.min.io/community/minio-kes/integrations/azure-keyvault/">Azure Key Vault</a></p></li>
<li><p><a class="reference external" href="https://docs.min.io/community/minio-kes/integrations/entrust-keycontrol/">Entrust KeyControl</a></p></li>
<li><p><a class="reference external" href="https://docs.min.io/community/minio-kes/integrations/fortanix-sdkms/">Fortanix SDKMS</a></p></li>
<li><p><a class="reference external" href="https://docs.min.io/community/minio-kes/integrations/google-cloud-secret-manager/">Google Cloud Secret Manager</a></p></li>
<li><p><a class="reference external" href="https://docs.min.io/community/minio-kes/integrations/hashicorp-vault-keystore/">HashiCorp Vault Keystore</a></p></li>
<li><p><a class="reference external" href="https://docs.min.io/community/minio-kes/integrations/thales-ciphertrust/">Thales CipherTrust Manager (formerly Gemalto KeySecure)</a></p></li>
</ul>
<section id="quickstart">
<span id="minio-encryption-sse-kms-quickstart"></span><h2><a class="toc-backref" href="#id1" role="doc-backlink">Quickstart</a><a class="headerlink" href="#quickstart" title="Permalink to this heading"></a></h2>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Enabling <abbr title="Server-Side Encryption">SSE</abbr> on a MinIO deployment automatically encrypts the backend data for that deployment using the default encryption key.</p>
<p>MinIO <em>requires</em> access to KES and the external KMS to decrypt the backend and start normally.
The KMS <strong>must</strong> maintain and provide access to the <a class="reference internal" href="../../reference/minio-server/settings/kes.html#envvar.MINIO_KMS_KES_KEY_NAME" title="envvar.MINIO_KMS_KES_KEY_NAME"><code class="xref minio minio-envvar docutils literal notranslate"><span class="pre">MINIO_KMS_KES_KEY_NAME</span></code></a>.
You cannot disable KES later or “undo” the <abbr title="Server-Side Encryption">SSE</abbr> configuration at a later point.</p>
</div>
<p>The following procedure uses the <code class="docutils literal notranslate"><span class="pre">play</span></code> MinIO <abbr title="Key Encryption Service">KES</abbr> sandbox for
supporting <abbr title="Server-Side Encryption">SSE</abbr> with SSE-KMS in evaluation and early development environments.</p>
<p>For extended development or production environments, use one of the following
supported external Key Management Services (KMS):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.min.io/community/minio-kes/integrations/aws-secrets-manager/">AWS Secrets Manager</a></p></li>
<li><p><a class="reference external" href="https://docs.min.io/community/minio-kes/integrations/azure-keyvault/">Azure Key Vault</a></p></li>
<li><p><a class="reference external" href="https://docs.min.io/community/minio-kes/integrations/entrust-keycontrol/">Entrust KeyControl</a></p></li>
<li><p><a class="reference external" href="https://docs.min.io/community/minio-kes/integrations/fortanix-sdkms/">Fortanix SDKMS</a></p></li>
<li><p><a class="reference external" href="https://docs.min.io/community/minio-kes/integrations/google-cloud-secret-manager/">Google Cloud Secret Manager</a></p></li>
<li><p><a class="reference external" href="https://docs.min.io/community/minio-kes/integrations/hashicorp-vault-keystore/">HashiCorp Vault Keystore</a></p></li>
<li><p><a class="reference external" href="https://docs.min.io/community/minio-kes/integrations/thales-ciphertrust/">Thales CipherTrust Manager (formerly Gemalto KeySecure)</a></p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The MinIO KES <code class="docutils literal notranslate"><span class="pre">Play</span></code> sandbox is public and grants root access to all created External Keys (EK).
Any <abbr title="External Key">EK</abbr> stored on the <code class="docutils literal notranslate"><span class="pre">Play</span></code> sandbox may be accessed or destroyed at any time, rendering protected data vulnerable or permanently unreadable.</p>
<ul class="simple">
<li><p><strong>Never</strong> use the <code class="docutils literal notranslate"><span class="pre">Play</span></code> sandbox to protect data you cannot afford to lose or reveal.</p></li>
<li><p><strong>Never</strong> generate <abbr title="External Key">EK</abbr> using names that reveal private, confidential, or internal naming conventions for your organization.</p></li>
<li><p><strong>Never</strong> use the <code class="docutils literal notranslate"><span class="pre">Play</span></code> sandbox for production environments.</p></li>
</ul>
</div>
<p>This procedure requires the following components:</p>
<ul class="simple">
<li><p>Install <a class="reference internal" href="../../reference/minio-mc.html#command-mc" title="mc"><code class="xref minio minio-mc docutils literal notranslate"><span class="pre">mc</span></code></a> on a machine with network access to the source
deployment. See the <code class="docutils literal notranslate"><span class="pre">mc</span></code> <a class="reference internal" href="../../reference/minio-mc.html#mc-install"><span class="std std-ref">Installation Quickstart</span></a> for
instructions on downloading and installing <code class="docutils literal notranslate"><span class="pre">mc</span></code>.</p></li>
<li><p>Install <a class="reference external" href="https://docs.min.io/community/minio-kes/">MinIO Key Encryption Service (KES)</a> on a machine with internet access.
See the <code class="docutils literal notranslate"><span class="pre">kes</span></code> <a class="reference external" href="https://docs.min.io/community/minio-kes/tutorials/getting-started/">Getting Started</a> guide for instructions on downloading, installing, and configuring KES.</p></li>
</ul>
<section id="create-an-encryption-key-for-sse-kms-encryption">
<h3>1) Create an Encryption Key for SSE-KMS Encryption<a class="headerlink" href="#create-an-encryption-key-for-sse-kms-encryption" title="Permalink to this heading"></a></h3>
<p>Use the <a class="reference external" href="https://docs.min.io/community/minio-kes/cli/">kes</a> command line tool to create a new External Key (EK) for use with SSE-KMS Encryption.</p>
<p>The following command retrieves the root <a class="reference external" href="https://docs.min.io/community/minio-kes/concepts/#authorization">identity</a> for the <code class="docutils literal notranslate"><span class="pre">play</span></code> KES server:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sSL<span class="w"> </span>--tlsv1.2<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-O<span class="w"> </span><span class="s1">&#39;https://raw.githubusercontent.com/minio/kes/master/root.key&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-O<span class="w"> </span><span class="s1">&#39;https://raw.githubusercontent.com/minio/kes/master/root.cert&#39;</span>
</pre></div>
</div>
<p>Set the following environment variables in the terminal or shell:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">KES_CLIENT_KEY</span><span class="o">=</span>root.key
<span class="nb">export</span><span class="w"> </span><span class="nv">KES_CLIENT_CERT</span><span class="o">=</span>root.cert
</pre></div>
</div>
<table class="docutils align-default" style="width: 100%">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 60.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><th class="stub"><p><code class="docutils literal notranslate"><span class="pre">KES_CLIENT_KEY</span></code></p></th>
<td><p>The private key for an <a class="reference external" href="https://docs.min.io/community/minio-kes/concepts/#authorization">identity</a> on the KES server.
The identity must grant access to at minimum the <code class="docutils literal notranslate"><span class="pre">/v1/create</span></code>, <code class="docutils literal notranslate"><span class="pre">/v1/generate</span></code>, and <code class="docutils literal notranslate"><span class="pre">/v1/list</span></code> <a class="reference external" href="https://docs.min.io/community/minio-kes/concepts/server-api/">API endpoints</a>.
This step uses the <code class="docutils literal notranslate"><span class="pre">root</span></code> identity for the MinIO <code class="docutils literal notranslate"><span class="pre">play</span></code> KES sandbox, which provides access to all operations on the KES server.</p></td>
</tr>
<tr class="row-even"><th class="stub"><p><code class="docutils literal notranslate"><span class="pre">KES_CLIENT_CERT</span></code></p></th>
<td><p>The corresponding certificate for the <a class="reference external" href="https://docs.min.io/community/minio-kes/concepts/#authorization">identity</a> on the KES server.
This step uses the <code class="docutils literal notranslate"><span class="pre">root</span></code> identity for the MinIO <code class="docutils literal notranslate"><span class="pre">play</span></code> KES sandbox, which provides access to all operations on the KES server.</p></td>
</tr>
</tbody>
</table>
<p>The following command creates a new <abbr title="External Key">EK</abbr> through KES.</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kes<span class="w"> </span>key<span class="w"> </span>create<span class="w"> </span>my-minio-sse-kms-key
</pre></div>
</div>
<p>This tutorial uses the example <code class="docutils literal notranslate"><span class="pre">my-minio-sse-kms-key</span></code> name for ease of reference.
Specify a unique key name to prevent collision with existing keys.</p>
</section>
<section id="configure-minio-for-sse-kms-object-encryption">
<h3>2) Configure MinIO for SSE-KMS Object Encryption<a class="headerlink" href="#configure-minio-for-sse-kms-object-encryption" title="Permalink to this heading"></a></h3>
<p>Specify the following environment variables in the shell or terminal on each
MinIO server host in the deployment:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">MINIO_KMS_KES_ENDPOINT</span><span class="o">=</span>https://play.min.io:7373
<span class="nb">export</span><span class="w"> </span><span class="nv">MINIO_KMS_KES_API_KEY</span><span class="o">=</span>&lt;API-key-identity-string-from-KES&gt;<span class="w"> </span><span class="c1"># Replace with the key string for your credentials</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">MINIO_KMS_KES_KEY_NAME</span><span class="o">=</span>my-minio-sse-s3-key
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><p>An API key is the preferred way to authenticate with the KES server, as it provides a streamlined and secure authentication process to the KES server.</p></li>
<li><p>Alternatively, specify the <a class="reference internal" href="../../reference/minio-server/settings/kes.html#envvar.MINIO_KMS_KES_KEY_FILE" title="envvar.MINIO_KMS_KES_KEY_FILE"><code class="xref minio minio-envvar docutils literal notranslate"><span class="pre">MINIO_KMS_KES_KEY_FILE</span></code></a> and <a class="reference internal" href="../../reference/minio-server/settings/kes.html#envvar.MINIO_KMS_KES_CERT_FILE" title="envvar.MINIO_KMS_KES_CERT_FILE"><code class="xref minio minio-envvar docutils literal notranslate"><span class="pre">MINIO_KMS_KES_CERT_FILE</span></code></a> instead of <a class="reference internal" href="../../reference/minio-server/settings/kes.html#envvar.MINIO_KMS_KES_API_KEY" title="envvar.MINIO_KMS_KES_API_KEY"><code class="xref minio minio-envvar docutils literal notranslate"><span class="pre">MINIO_KMS_KES_API_KEY</span></code></a>.</p>
<p>API keys are mutually exclusive with certificate-based authentication.
Specify <em>either</em> the API key variable <em>or</em> the Key File and Cert File variables.</p>
</li>
<li><p>The documentation on this site uses API keys.</p></li>
</ul>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 27.3%" />
<col style="width: 72.7%" />
</colgroup>
<tbody>
<tr class="row-odd"><th class="stub"><p><a class="reference internal" href="../../reference/minio-server/settings/kes.html#envvar.MINIO_KMS_KES_ENDPOINT" title="envvar.MINIO_KMS_KES_ENDPOINT"><code class="xref minio minio-envvar docutils literal notranslate"><span class="pre">MINIO_KMS_KES_ENDPOINT</span></code></a></p></th>
<td><p>The endpoint for the MinIO <code class="docutils literal notranslate"><span class="pre">Play</span></code> KES service.</p></td>
</tr>
<tr class="row-even"><th class="stub"><p><a class="reference internal" href="../../reference/minio-server/settings/kes.html#envvar.MINIO_KMS_KES_API_KEY" title="envvar.MINIO_KMS_KES_API_KEY"><code class="xref minio minio-envvar docutils literal notranslate"><span class="pre">MINIO_KMS_KES_API_KEY</span></code></a></p></th>
<td><p>The API key <a class="reference external" href="https://docs.min.io/community/minio-kes/tutorials/kes-for-minio/#kes-server-setup">generated by KES</a> for the MinIO deployment.
The identity of the API key must grant permission to create, generate, and decrypt keys.</p>
<p>The API key is the preferred way to authenticate with the KES server.
If circumstances require it, specify the <a class="reference internal" href="../../reference/minio-server/settings/kes.html#envvar.MINIO_KMS_KES_KEY_FILE" title="envvar.MINIO_KMS_KES_KEY_FILE"><code class="xref minio minio-envvar docutils literal notranslate"><span class="pre">MINIO_KMS_KES_KEY_FILE</span></code></a> and <a class="reference internal" href="../../reference/minio-server/settings/kes.html#envvar.MINIO_KMS_KES_CERT_FILE" title="envvar.MINIO_KMS_KES_CERT_FILE"><code class="xref minio minio-envvar docutils literal notranslate"><span class="pre">MINIO_KMS_KES_CERT_FILE</span></code></a> instead.
Specify <em>either</em> the API key <em>or</em> the Key File and Cert File.
Do <em>not</em> populate all three environment variables.</p>
</td>
</tr>
<tr class="row-odd"><th class="stub"><p><a class="reference internal" href="../../reference/minio-server/settings/kes.html#envvar.MINIO_KMS_KES_KEY_NAME" title="envvar.MINIO_KMS_KES_KEY_NAME"><code class="xref minio minio-envvar docutils literal notranslate"><span class="pre">MINIO_KMS_KES_KEY_NAME</span></code></a></p></th>
<td><p>The name of the External Key (EK) to use for performing SSE encryption operations.
KES retrieves the <abbr title="External Key">EK</abbr> from the configured Key Management Service (KMS).
Specify the name of the key created in the previous step.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="restart-the-minio-deployment-to-enable-sse-kms">
<h3>3) Restart the MinIO Deployment to Enable SSE-KMS<a class="headerlink" href="#restart-the-minio-deployment-to-enable-sse-kms" title="Permalink to this heading"></a></h3>
<p>You must restart the MinIO deployment to apply the configuration changes.
Use the <a class="reference internal" href="../../reference/minio-mc-admin/mc-admin-service.html#mc.admin.service.restart" title="mc.admin.service.restart"><code class="xref minio minio-mc-cmd docutils literal notranslate"><span class="pre">mc</span> <span class="pre">admin</span> <span class="pre">service</span> <span class="pre">restart</span></code></a> command to restart the deployment.</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>mc<span class="w"> </span>admin<span class="w"> </span>service<span class="w"> </span>restart<span class="w"> </span>ALIAS
</pre></div>
</div>
<p>Replace <code class="docutils literal notranslate"><span class="pre">ALIAS</span></code> with the <a class="reference internal" href="../../reference/minio-mc/mc-alias-set.html#alias"><span class="std std-ref">alias</span></a> of the deployment to restart.</p>
</section>
<section id="configure-automatic-bucket-encryption">
<h3>4) Configure Automatic Bucket Encryption<a class="headerlink" href="#configure-automatic-bucket-encryption" title="Permalink to this heading"></a></h3>
<p>Use the <a class="reference internal" href="../../reference/minio-mc/mc-encrypt-set.html#command-mc.encrypt.set" title="mc.encrypt.set"><code class="xref minio minio-mc docutils literal notranslate"><span class="pre">mc</span> <span class="pre">encrypt</span> <span class="pre">set</span></code></a> command to enable automatic SSE-KMS protection of all objects written to a specific bucket.</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>mc<span class="w"> </span>encrypt<span class="w"> </span><span class="nb">set</span><span class="w"> </span>sse-kms<span class="w"> </span>my-minio-sse-kms-key<span class="w"> </span>ALIAS/BUCKET
</pre></div>
</div>
<ul class="simple">
<li><p>Replace <a class="reference internal" href="../../reference/minio-mc/mc-encrypt-set.html#mc.encrypt.set.ALIAS" title="mc.encrypt.set.ALIAS"><code class="xref minio minio-mc-cmd docutils literal notranslate"><span class="pre">ALIAS</span></code></a> with the
<a class="reference internal" href="../../reference/minio-mc/mc-alias.html#command-mc.alias" title="mc.alias"><code class="xref minio minio-mc docutils literal notranslate"><span class="pre">alias</span></code></a> of the MinIO deployment on which you enabled SSE-KMS.</p></li>
<li><p>Replace <a class="reference internal" href="../../reference/minio-mc/mc-encrypt-set.html#mc.encrypt.set.ALIAS" title="mc.encrypt.set.ALIAS"><code class="xref minio minio-mc-cmd docutils literal notranslate"><span class="pre">BUCKET</span></code></a>  with the full path to the
bucket or bucket prefix on which you want to enable automatic SSE-KMS.</p></li>
</ul>
<p>Objects written to the specified bucket are automatically encrypted using the specified <abbr title="External Key">EK</abbr>.</p>
<p>Repeat this step for each bucket on which you want to enable automatic SSE-KMS encryption.
You can generate additional keys per bucket or bucket prefix, such that the scope of each <abbr title="External Key">EK</abbr> is limited to a subset of objects.</p>
</section>
</section>
<section id="secure-erasure-and-locking">
<span id="minio-encryption-sse-kms-erasure-locking"></span><h2><a class="toc-backref" href="#id2" role="doc-backlink">Secure Erasure and Locking</a><a class="headerlink" href="#secure-erasure-and-locking" title="Permalink to this heading"></a></h2>
<p>SSE-KMS protects objects using an <abbr title="External Key">EK</abbr> specified either as part of the
bucket automatic encryption settings <em>or</em> as part of the write operation.
MinIO therefore <em>requires</em> access to that <abbr title="External Key">EK</abbr> for decrypting that object.</p>
<ul class="simple">
<li><p>Disabling the <abbr title="External Key">EK</abbr> temporarily locks objects encrypted with that <abbr title="External Key">EK</abbr> by
rendering them unreadable. You can later enable the <abbr title="External Key">EK</abbr> to resume
normal read operations on those objects.</p></li>
<li><p>Deleting the <abbr title="External Key">EK</abbr> renders all objects encrypted by that <abbr title="External Key">EK</abbr>
<em>permanently</em> unreadable. If the KMS does not have or support backups
of the <abbr title="External Key">EK</abbr>, this process is <em>irreversible</em>.</p></li>
</ul>
<p>The scope of a single <abbr title="External Key">EK</abbr> depends on:</p>
<ul class="simple">
<li><p>Which buckets specified that <abbr title="External Key">EK</abbr> for automatic SSE-KMS encryption,
<em>and</em></p></li>
<li><p>Which write operations specified that <abbr title="External Key">EK</abbr> when requesting SSE-KMS encryption.</p></li>
</ul>
<p>For example, consider a MinIO deployment using one <abbr title="External Key">EK</abbr> per bucket.
Disabling a single <abbr title="External Key">EK</abbr> renders all objects in the associated bucket
unreadable without affecting other buckets. If the deployment instead used
one <abbr title="External Key">EK</abbr> for all objects and buckets, disabling that <abbr title="External Key">EK</abbr> renders all
objects in the deployment unreadable.</p>
</section>
<section id="encryption-process">
<span id="minio-encryption-sse-kms-encryption-process"></span><h2><a class="toc-backref" href="#id3" role="doc-backlink">Encryption Process</a><a class="headerlink" href="#encryption-process" title="Permalink to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section describes MinIO internal logic and functionality.
This information is purely educational and is not a prerequisite for
configuring or implementing any MinIO feature.</p>
</div>
<p>SSE-KMS uses an External Key (EK) managed by the configured Key Management
System (KMS) for performing cryptographic operations and protecting objects.
The table below describes each stage of the encryption process:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Stage</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SSE-Enabled Write Operation</p></td>
<td><p>MinIO receives a write operation requesting SSE-KMS encryption.
The write operation <em>must</em> have an associated External Key (EK) to use
for encrypting the object.</p>
<ul class="simple">
<li><p>For write operations in buckets with automatic SSE-KMS enabled,
MinIO uses the bucket <abbr title="External Key">EK</abbr>. If the write operation includes an
explicit EK, MinIO uses that <em>instead</em> of the bucket EK.</p></li>
<li><p>For write operations in buckets <em>without</em> automatic SSE-KMS enabled,
MinIO uses the <abbr title="External Key">EK</abbr> specified to the write operation.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Generate the Data Encryption Key (DEK)</p></td>
<td><p>MinIO generates a Data Encryption Key (DEK) using the <abbr title="External Key">EK</abbr>.
Specifically, <a class="reference external" href="https://github.com/minio/kes">MinIO Key Encryption Service (KES)</a> requests a new cryptographic key from the KMS using the <abbr title="External Key">EK</abbr> as the “root” key.</p>
<p>KES returns both the plain-text <em>and</em> an <abbr title="External Key">EK</abbr>-encrypted representation of the DEK.
MinIO stores the encrypted representation as part of the object metadata.</p>
</td>
</tr>
<tr class="row-even"><td><p>Generate the Key Encryption Key (KEK)</p></td>
<td><p>MinIO uses a deterministic algorithm to generate a 256-bit unique Key Encryption Key (KEK).
The key-derivation algorithm uses a pseudo-random function that takes the plain-text <abbr title="Data Encryption Key">DEK</abbr>, a randomly generated initialization vector, and a context consisting of values like the bucket and object name.</p>
<p>MinIO generates the KEK at the time of each cryptographic encryption or decryption operation and <em>never</em> stores the KEK to a drive.</p>
</td>
</tr>
<tr class="row-odd"><td><p>Generate the Object Encryption Key (OEK)</p></td>
<td><p>MinIO generates a random 256-bit unique Object Encryption Key (OEK) and uses that key to encrypt the object.
MinIO never stores the plaintext representation of the OEK on a drive.
The plaintext OEK resides in RAM during cryptographic operations.</p>
</td>
</tr>
<tr class="row-even"><td><p>Encrypt the Object</p></td>
<td><p>MinIO uses the <abbr title="Object Encryption Key">OEK</abbr> to encrypt the object <em>prior</em> to storing the
object to the drive. MinIO then encrypts the <abbr title="Object Encryption Key">OEK</abbr> with the <abbr title="Key Encryption Key">KEK</abbr>.</p>
<p>MinIO stores the encrypted representation of the <abbr title="Object Encryption Key">OEK</abbr> and <abbr title="Data Encryption Key">DEK</abbr> as part
of the metadata.</p>
</td>
</tr>
</tbody>
</table>
<p>For read operations, MinIO decrypts the object by retrieving the <abbr title="External Key">EK</abbr> to
decrypt the <abbr title="Data Encryption Key">DEK</abbr>. MinIO then regenerates the <abbr title="Key Encryption Key">KEK</abbr>, decrypts the <abbr title="Object Encryption Key">OEK</abbr>, and
decrypts the object.</p>
</section>
</section>


            </div><div class="footer">
   This work is licensed under a
   <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License.</a>
   2020-Present, MinIO, Inc. 
   <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
      <img height="10" alt="Creative Commons License" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
   </a>
</div>
         </div>
      </div>
   </section><div id="cookie">
    <div class="container">
        <div class="cookie__text">
            <strong>Your privacy is important to us:</strong>
            We use cookies in order to give you a better experience. If you wish so, you can always review our 
            <a target="_blank" rel="noreferrer noopener" href="https://min.io/privacy-policy">Privacy Policy</a>.
        </div>

        <button type="button" id="cookie__btn">Accept</button>
    </div>
</div><script>
    // Dark mode and read mode detection

    // Dark mode
    /*var isDarkMode = localStorage.getItem("dark-mode");
    var dmToggleBtn = document.getElementById("dark-mode-toggle");
    if (isDarkMode === "true") {
       document.documentElement.classList.add("dark-mode");
       dmToggleBtn.classList.add("active");
    }

    // Read mode
    var isReadMode = localStorage.getItem("read-mode");
    var rmToggleBtn = document.getElementById("read-mode-toggle");

    if (isReadMode === "true") {
        document.documentElement.classList.add("read-mode");
        rmToggleBtn.classList.add("active");
    }*/
 </script>
  </body>
</html>