

<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Upgrade Legacy MinIO Operators &#8212; MinIO Object Storage (AGPLv3)</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/main.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script src="../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js"></script>
    <script src="../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/instantsearch.js@4"></script>
    <script defer="defer" src="../../_static/js/main.js"></script>
    <script defer="defer" src="../../_static/js/instantSearch.js"></script>
    <link rel="canonical" href="https://docs.min.io/community/minio-object-store/operations/deployments/k8s-upgrade-minio-operator-4.5.7-earlier.html" />
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /><meta name="pagename" content="operations/deployments/k8s-upgrade-minio-operator-4.5.7-earlier"/>

<!-- Preload fonts and scripts -->
<link rel="preload" href="../../_static/fonts/inter/Inter-Regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="../../_static/fonts/inter/Inter-Medium.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="../../_static/fonts/inter/Inter-Bold.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preconnect" href="https://E1CSOK3UC2-dsn.algolia.net" crossorigin />

<!-- Google Tag Manager: docs.min.io -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-56L9FLVL');</script>

<!-- Google Tag Manager: main -->
<script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TWQNHTD');
</script>

<!-- Google Analytics -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-56860620-1', 'auto');
    ga('send', 'pageview');
</script>

<!-- Linkedin -->
<script>
    _linkedin_partner_id = "1153348";
    window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
    window._linkedin_data_partner_ids.push(_linkedin_partner_id);

    (function(l) {
    if (!l){window.lintrk = function(a,b){window.lintrk.q.push([a,b])};
    window.lintrk.q=[]}
    var s = document.getElementsByTagName("script")[0];
    var b = document.createElement("script");
    b.type = "text/javascript";b.async = true;
    b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
    s.parentNode.insertBefore(b, s);})(window.lintrk);
</script>

<!-- Leadfeeder -->
<script>
    (function(){
        window.ldfdr = window.ldfdr || {};
        (function(d, s, ss, fs){
        fs = d.getElementsByTagName(s)[0];
        function ce(src){
            var cs  = d.createElement(s);
            cs.src = src;
            setTimeout(function(){fs.parentNode.insertBefore(cs,fs)}, 1);
        }
        ce(ss);
        })(document, 'script', 'https://sc.lfeeder.com/lftracker_v1_DzLR5a5kKJA7BoQ2.js');
    })();
</script>
   
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  


  </head><body><!-- Google Tag Manager: docs.min.io (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-56L9FLVL" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><header class="header inactive">
   <div class="container">
      <div class="header__inner">
         <a href="https://min.io?jmp=docs-minio-object-store" class="header__logo">
            <svg viewBox="0 0 162.612 24.465">
               <path d="M52.751.414h9.108v23.63h-9.108zM41.711.74l-18.488 9.92a.919.919 0 0 1-.856 0L3.879.74A2.808 2.808 0 0 0 2.558.414h-.023A2.4 2.4 0 0 0 0 2.641v21.376h9.1V13.842a.918.918 0 0 1 1.385-.682l10.361 5.568a3.634 3.634 0 0 0 3.336.028l10.933-5.634a.917.917 0 0 1 1.371.69v10.205h9.1V2.641A2.4 2.4 0 0 0 43.055.414h-.023a2.808 2.808 0 0 0-1.321.326zm65.564-.326h-9.237v10.755a.913.913 0 0 1-1.338.706L72.762.675a2.824 2.824 0 0 0-1.191-.261h-.016a2.4 2.4 0 0 0-2.535 2.227v21.377h9.163V13.275a.914.914 0 0 1 1.337-.707l24.032 11.2a2.813 2.813 0 0 0 1.188.26 2.4 2.4 0 0 0 2.535-2.227zm7.161 23.63V.414h4.191v23.63zm28.856.421c-11.274 0-19.272-4.7-19.272-12.232C124.02 4.741 132.066 0 143.292 0s19.32 4.7 19.32 12.233-7.902 12.232-19.32 12.232zm0-21.333c-8.383 0-14.84 3.217-14.84 9.1 0 5.926 6.457 9.1 14.84 9.1s14.887-3.174 14.887-9.1c0-5.883-6.504-9.1-14.887-9.1z" />
            </svg>
         </a>
         
         <!--
         <div class="header__actions">
            

            <button id="dark-mode-toggle" type="button" class="icon icon--switch"><svg width="21" height="21" viewBox="0 0 48 48" fill="currentColor">
    <path d="M24 42q-7.5 0-12.75-5.25T6 24q0-6.75 3.975-11.45Q13.95 7.85 20.4 6.5q2.05-.4 2.8.7t-.05 3q-.45 1.15-.7 2.35-.25 1.2-.25 2.45 0 4.5 3.15 7.65Q28.5 25.8 33 25.8q1.25 0 2.425-.225 1.175-.225 2.275-.625 2.15-.8 3.2.075 1.05.875.55 2.975-1.35 6.05-6.05 10.025Q30.7 42 24 42Zm0-3q5.45 0 9.5-3.375t5.05-7.925q-1.25.55-2.675.825Q34.45 28.8 33 28.8q-5.75 0-9.775-4.025T19.2 15q0-1.2.25-2.575.25-1.375.9-3.125-4.9 1.35-8.125 5.475Q9 18.9 9 24q0 6.25 4.375 10.625T24 39Zm-.2-14.85Z" />
</svg><svg width="17" height="17" viewBox="0 0 17 17">
    <path d="M8.5 2.898c-.167 0-.306-.055-.415-.164s-.164-.248-.164-.415V.58c0-.167.055-.306.164-.415S8.333 0 8.5 0s.306.055.415.164.164.248.164.415v1.739c0 .167-.055.306-.164.415s-.248.164-.415.164zm3.96 1.642c-.116-.116-.174-.251-.174-.406s.058-.29.174-.406l1.217-1.236c.116-.116.254-.174.415-.174s.299.058.415.174.174.251.174.406-.058.29-.174.406L13.272 4.54c-.116.116-.251.174-.406.174s-.29-.058-.406-.174zm2.222 4.54c-.167 0-.306-.055-.415-.164s-.164-.248-.164-.415.055-.306.164-.415.248-.164.415-.164h1.739c.167 0 .306.055.415.164S17 8.333 17 8.5s-.055.306-.164.415-.248.164-.415.164h-1.739zM8.5 17c-.167 0-.306-.055-.415-.164s-.164-.248-.164-.415v-1.739c0-.167.055-.306.164-.415s.248-.164.415-.164.306.055.415.164.164.248.164.415v1.739c0 .167-.055.306-.164.415S8.667 17 8.5 17zM3.728 4.54L2.492 3.323c-.116-.116-.174-.254-.174-.415s.058-.299.174-.415.251-.174.406-.174.29.058.406.174L4.54 3.728c.116.116.174.251.174.406s-.058.29-.174.406c-.116.103-.254.155-.415.155s-.293-.052-.396-.155zm9.968 9.968l-1.236-1.236c-.116-.116-.174-.251-.174-.406s.058-.29.174-.406c.103-.103.235-.155.396-.155s.299.052.415.155l1.256 1.217c.116.116.171.254.164.415s-.061.299-.164.415c-.116.116-.254.174-.415.174s-.299-.058-.415-.174h0zM.58 9.08c-.167 0-.306-.055-.415-.164S0 8.667 0 8.5s.055-.306.164-.415.248-.164.415-.164h1.739c.167 0 .306.055.415.164s.164.248.164.415-.055.306-.164.415-.248.164-.415.164H.58zm1.912 5.428c-.116-.116-.174-.251-.174-.406s.058-.29.174-.406l1.236-1.236c.103-.103.235-.155.396-.155s.299.052.415.155c.116.116.174.254.174.415s-.058.299-.174.415l-1.217 1.217c-.116.116-.254.174-.415.174s-.299-.058-.415-.174h0zM8.5 13.136a4.47 4.47 0 0 1-3.284-1.352A4.47 4.47 0 0 1 3.864 8.5a4.47 4.47 0 0 1 1.352-3.284A4.47 4.47 0 0 1 8.5 3.864a4.47 4.47 0 0 1 3.284 1.352A4.47 4.47 0 0 1 13.136 8.5a4.47 4.47 0 0 1-1.352 3.284A4.47 4.47 0 0 1 8.5 13.136zm0-1.159a3.35 3.35 0 0 0 2.463-1.014A3.35 3.35 0 0 0 11.977 8.5a3.35 3.35 0 0 0-1.014-2.463A3.35 3.35 0 0 0 8.5 5.023a3.35 3.35 0 0 0-2.463 1.014A3.35 3.35 0 0 0 5.023 8.5a3.35 3.35 0 0 0 1.014 2.463A3.35 3.35 0 0 0 8.5 11.977z" fill="currentColor" />
</svg>
               Dark Mode
            </button>
         </div>
         -->
      </div>
  
      <h2 class="header__title hidden-rm">Documentation</h2>

      

      <!--<div class="platform-nav">
    <div class="platform-nav__main">
        <div class="container">
        </div>
        <button type="button" class="icon search-toggle search-toggle--keyboard visible-rm"><svg width="14" height="15">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 6.5a5 5 0 1 1-10 0 5 5 0 0 1 10 0Zm-1.59 5.535a6.5 6.5 0 1 1 1.179-.931l1.845 2.096a.75.75 0 0 1-1.127.99L9.91 12.036Z"/>
</svg>
            Search
        </button>
    </div>
</div> -->
         <div id="search">
            <div class="search__inner">
               <div id="search-box"></div>
               
               <div class="search__dropdown">
                  <div id="search-filters"></div>
                  <div id="search-clear"></div>
                  <div id="search-results"></div>
                  <div id="search-powered-by"></div>
               </div>
            </div>
         </div>
   </div>
 </header>
   <section class="content">
      <div class="container">
         <div class="sidebar inactive scrollbar">
            <div class="hide-aside visible-rm">
               <button type="button" class="icon"><svg width="12" height="12">
    <path d="M11.253 1.691L10.125.563 5.653 5.035 1.181.563.053 1.691l4.472 4.472-4.472 4.472 1.128 1.128 4.472-4.472 4.472 4.472 1.128-1.128-4.472-4.472z" fill-rule="evenodd"/>
</svg>
                     Close Doc Navigation
               </button>
            </div>

            <a class="sidebar__title" href="../../index.html">MinIO Object Storage</a>
            
            
      <nav
         class="docs"
         role="navigation"
      >
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation and Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../replication/multi-site-replication.html">Site Replication Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts.html">Core Operational Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring.html">Monitoring and Alerts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../external-iam.html">External Identity Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server-side-encryption.html">Data Encryption (SSE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network-encryption.html">Network Encryption (TLS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../checklists.html">Deployment Checklists</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-recovery.html">Recover after Hardware Failure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration/minio-console.html">MinIO Console</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration/object-management.html">Object Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration/monitoring.html">Monitoring Bucket and Object Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration/identity-access-management.html">Identity and Access Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration/server-side-encryption.html">Server-Side Encryption of Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration/bucket-replication.html">Bucket Replication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration/batch-framework.html">Batch Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration/concepts.html">Core Administration Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers/minio-drivers.html">Software Development Kits (SDK)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers/security-token-service.html">Security Token Service (STS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers/transforms-with-object-lambda.html">Transforms with Object Lambda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers/file-transfer-protocol.html">File Transfer Protocol (FTP/SFTP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/kubernetes.html">Kubernetes Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/baremetal.html">Baremetal Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/s3-api-compatibility.html">S3 API Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../integrations/integrations.html">Integrations</a></li>
</ul>

      </nav>
         </div><div class="content__toc scrollbar scrollbar--hover">
  	<button data-aside-toggle="doc" class="icon" type="button"><svg width="17" height="13" viewbox="0 0 17 13">
    <path d="M16.034 0H.966C.433 0 0 .346 0 .773s.433.773.966.773h15.068c.533 0 .966-.346.966-.773S16.567 0 16.034 0zm0 5.409H.966c-.533 0-.966.346-.966.773s.433.773.966.773h15.068c.533 0 .966-.346.966-.773s-.433-.773-.966-.773zm0 5.409H.966c-.533 0-.966.346-.966.773s.433.773.966.773h15.068c.533 0 .966-.346.966-.773s-.433-.773-.966-.773z" />
</svg> TOC Menu
  	</button>

  	<div id="content-toc"></div>
		<button class="icon search-toggle" type="button"><svg width="14" height="15">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 6.5a5 5 0 1 1-10 0 5 5 0 0 1 10 0Zm-1.59 5.535a6.5 6.5 0 1 1 1.179-.931l1.845 2.096a.75.75 0 0 1-1.127.99L9.91 12.036Z"/>
</svg> Search
		</button>
</div>

         <div class="content__main">
            <div class="content__body">
               
  <section id="upgrade-legacy-minio-operators">
<h1>Upgrade Legacy MinIO Operators<a class="headerlink" href="#upgrade-legacy-minio-operators" title="Permalink to this heading"></a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#upgrade-minio-operator-4-5-8-and-later-to-5-0-15" id="id6">Upgrade MinIO Operator 4.5.8 and Later to 5.0.15</a></p></li>
<li><p><a class="reference internal" href="#upgrade-minio-operator-4-2-3-through-4-5-7-to-4-5-8" id="id7">Upgrade MinIO Operator 4.2.3 through 4.5.7 to 4.5.8</a></p></li>
<li><p><a class="reference internal" href="#upgrade-minio-operator-4-0-0-through-4-2-2-to-4-2-3" id="id8">Upgrade MinIO Operator 4.0.0 through 4.2.2 to 4.2.3</a></p></li>
<li><p><a class="reference internal" href="#upgrade-minio-operator-3-0-0-through-3-0-29-to-4-2-2" id="id9">Upgrade MinIO Operator 3.0.0 through 3.0.29 to 4.2.2</a></p></li>
</ul>
</nav>
<p>MinIO supports the following upgrade paths for older versions of the MinIO Operator:</p>
<table class="docutils align-default" style="width: 100%">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Current Version</p></th>
<th class="head"><p>Supported Upgrade Target</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>5.0.15 or later</p></td>
<td><p>5.0.18</p></td>
</tr>
<tr class="row-odd"><td><p>5.0.0 to 5.0.14</p></td>
<td><p>5.0.15</p></td>
</tr>
<tr class="row-even"><td><p>4.2.3 to 4.5.7</p></td>
<td><p>4.5.8</p></td>
</tr>
<tr class="row-odd"><td><p>4.0.0 through 4.2.2</p></td>
<td><p>4.2.3</p></td>
</tr>
<tr class="row-even"><td><p>3.X.X</p></td>
<td><p>4.2.2</p></td>
</tr>
</tbody>
</table>
<p>To upgrade from Operator to 5.0.18 from version 4.5.7 or earlier, you must first upgrade to version 4.5.8, then upgrade to 5.0.15.
Depending on your current version, you may need to do one or more intermediate upgrades to reach v4.5.8.</p>
<p>After upgrading to 5.0.15, see <a class="reference internal" href="k8s-upgrade-minio-operator-kubernetes.html#minio-k8s-upgrade-minio-operator"><span class="std std-ref">Upgrade MinIO Operator</span></a> to upgrade to the latest version.</p>
<section id="upgrade-minio-operator-4-5-8-and-later-to-5-0-15">
<span id="minio-k8s-upgrade-minio-operator-to-5-0-15"></span><h2><a class="toc-backref" href="#id6" role="doc-backlink">Upgrade MinIO Operator 4.5.8 and Later to 5.0.15</a><a class="headerlink" href="#upgrade-minio-operator-4-5-8-and-later-to-5-0-15" title="Permalink to this heading"></a></h2>
<div class="note admonition">
<p class="admonition-title">Prerequisites</p>
<p>This procedure requires the following:</p>
<ul class="simple">
<li><p>You have an existing MinIO Operator deployment running 4.5.8 or later</p></li>
<li><p>Your Kubernetes cluster runs 1.21.0 or later</p></li>
<li><p>Your local host has <code class="docutils literal notranslate"><span class="pre">kubectl</span></code> installed and configured with access to the Kubernetes cluster</p></li>
</ul>
</div>
<p>This procedure upgrades the MinIO Operator from any 4.5.8 or later release to 5.0.15</p>
<section id="tenant-custom-resource-definition-changes">
<h3>Tenant Custom Resource Definition Changes<a class="headerlink" href="#tenant-custom-resource-definition-changes" title="Permalink to this heading"></a></h3>
<p>The following changes apply for Operator v5.0.0 or later:</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">.spec.s3</span></code> field is replaced by the <code class="docutils literal notranslate"><span class="pre">.spec.features</span></code> field.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">.spec.credsSecret</span></code> field is replaced by the <code class="docutils literal notranslate"><span class="pre">.spec.configuration</span></code> field.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.spec.credsSecret</span></code> should hold all the environment variables for the MinIO deployment that contain sensitive information and should not show in <code class="docutils literal notranslate"><span class="pre">.spec.env</span></code>.
This change impacts the Tenant <abbr title="CustomResourceDefinition">CRD</abbr> and only impacts users editing a tenant YAML directly, such as through Helm or Kustomize.</p>
</li>
<li><p>Both the <strong>Log Search API</strong> (<code class="docutils literal notranslate"><span class="pre">.spec.log</span></code>) and <strong>Prometheus</strong> (<code class="docutils literal notranslate"><span class="pre">.spec.prometheus</span></code>) deployments have been removed.
However, existing deployments are left running as standalone deployments / statefulsets with no connection to the Tenant CR.
Deleting the Tenant <abbr title="Custom Resource Definition">CRD</abbr> does <strong>not</strong> cascade to the log or Prometheus deployments.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>MinIO recommends that you create a yaml file to manage these deployments going forward.</p>
</div>
</li>
</ul>
</section>
<section id="log-search-and-prometheus">
<h3>Log Search and Prometheus<a class="headerlink" href="#log-search-and-prometheus" title="Permalink to this heading"></a></h3>
<p>The latest releases of Operator remove Log Search and Prometheus from included Operator tools.
The following steps back up the existing yaml files, perform some clean up, and provide steps to continue using either or both of these functions.</p>
<ol class="arabic">
<li><p>Back up Prometheus and Log Search yaml files.</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">TENANT_NAME</span><span class="o">=</span>myminio
<span class="nb">export</span><span class="w"> </span><span class="nv">NAMESPACE</span><span class="o">=</span>mynamespace
kubectl<span class="w"> </span>-n<span class="w"> </span><span class="nv">$NAMESPACE</span><span class="w"> </span>get<span class="w"> </span>secret<span class="w"> </span><span class="nv">$TENANT_NAME</span>-log-secret<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$TENANT_NAME</span>-log-secret.yaml
kubectl<span class="w"> </span>-n<span class="w"> </span><span class="nv">$NAMESPACE</span><span class="w"> </span>get<span class="w"> </span>cm<span class="w"> </span><span class="nv">$TENANT_NAME</span>-prometheus-config-map<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$TENANT_NAME</span>-prometheus-config-map.yaml
kubectl<span class="w"> </span>-n<span class="w"> </span><span class="nv">$NAMESPACE</span><span class="w"> </span>get<span class="w"> </span>sts<span class="w"> </span><span class="nv">$TENANT_NAME</span>-prometheus<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$TENANT_NAME</span>-prometheus.yaml
kubectl<span class="w"> </span>-n<span class="w"> </span><span class="nv">$NAMESPACE</span><span class="w"> </span>get<span class="w"> </span>sts<span class="w"> </span><span class="nv">$TENANT_NAME</span>-log<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$TENANT_NAME</span>-log.yaml
kubectl<span class="w"> </span>-n<span class="w"> </span><span class="nv">$NAMESPACE</span><span class="w"> </span>get<span class="w"> </span>deployment<span class="w"> </span><span class="nv">$TENANT_NAME</span>-log-search-api<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$TENANT_NAME</span>-log-search-api.yaml
kubectl<span class="w"> </span>-n<span class="w"> </span><span class="nv">$NAMESPACE</span><span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span><span class="nv">$TENANT_NAME</span>-log-hl-svc<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$TENANT_NAME</span>-log-hl-svc.yaml
kubectl<span class="w"> </span>-n<span class="w"> </span><span class="nv">$NAMESPACE</span><span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span><span class="nv">$TENANT_NAME</span>-log-search-api<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$TENANT_NAME</span>-log-search-api-svc.yaml
kubectl<span class="w"> </span>-n<span class="w"> </span><span class="nv">$NAMESPACE</span><span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span><span class="nv">$TENANT_NAME</span>-prometheus-hl-svc<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$TENANT_NAME</span>-prometheus-hl-svc.yaml
</pre></div>
</div>
<ul class="simple">
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">myminio</span></code> with the name of the tenant on the operator deployment you are upgrading.</p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">mynamespace</span></code> with the namespace for the tenant on the operator deployment you are upgrading.</p></li>
</ul>
<p>Repeat for each tenant.</p>
</li>
<li><p>Remove <code class="docutils literal notranslate"><span class="pre">.metadata.ownerReferences</span></code> for all backed up files for all tenants.</p></li>
<li><p><em>(Optional)</em> To continue using Log Search API and Prometheus, add the following variables to the tenantâ€™s yaml specification file under <code class="docutils literal notranslate"><span class="pre">.spec.env</span></code></p>
<p>Use the following command to edit a tenant:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>edit<span class="w"> </span>tenants<span class="w"> </span>&lt;TENANT-NAME&gt;<span class="w"> </span>-n<span class="w"> </span>&lt;TENANT-NAMESPACE&gt;
</pre></div>
</div>
<ul class="simple">
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;TENANT-NAME&gt;</span></code> with the name of the tenant to modify.</p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;TENANT-NAMESPACE&gt;</span></code> with the namespace of the tenant you are modifying.</p></li>
</ul>
<p>Add the following values under <code class="docutils literal notranslate"><span class="pre">.spec.env</span></code> in the file:</p>
<div class="copyable highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MINIO_LOG_QUERY_AUTH_TOKEN</span>
<span class="w">  </span><span class="nt">valueFrom</span><span class="p">:</span>
<span class="w">    </span><span class="nt">secretKeyRef</span><span class="p">:</span>
<span class="w">      </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MINIO_LOG_QUERY_AUTH_TOKEN</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;TENANT_NAME&gt;-log-secret</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MINIO_LOG_QUERY_URL</span>
<span class="w">  </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://&lt;TENANT_NAME&gt;-log-search-api:8080</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MINIO_PROMETHEUS_JOB_ID</span>
<span class="w">  </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">minio-job</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MINIO_PROMETHEUS_URL</span>
<span class="w">  </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://&lt;TENANT_NAME&gt;-prometheus-hl-svc:9001</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;TENANT_NAME&gt;</span></code> in the <code class="docutils literal notranslate"><span class="pre">name</span></code> or <code class="docutils literal notranslate"><span class="pre">value</span></code> lines with the name of your tenant.</p></li>
</ul>
</li>
</ol>
</section>
<section id="procedure">
<h3>Procedure<a class="headerlink" href="#procedure" title="Permalink to this heading"></a></h3>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-0">
Upgrade using Kustomize</label><div class="sd-tab-content docutils">
<p>The following procedure upgrades the MinIO Operator using Kustomize.</p>
<p>For Operator versions 5.0.1 to 5.0.14 installed with the MinIO Kubernetes Plugin, follow the Kustomize instructions below to upgrade to 5.0.15 or later.
If you installed the Operator using <a class="reference internal" href="k8s-deploy-operator-helm-on-kubernetes.html#minio-k8s-deploy-operator-helm"><span class="std std-ref">Helm</span></a>, use the <span class="guilabel">Upgrade using Helm</span> instructions instead.</p>
<ol class="arabic">
<li><p><em>(Optional)</em> Update each MinIO Tenant to the latest stable MinIO Version.</p>
<p>Upgrading MinIO regularly ensures your Tenants have the latest features and performance improvements.
Test upgrades in a lower environment such as a Dev or QA Tenant, before applying to your production Tenants.
See <a class="reference internal" href="k8s-upgrade-minio-tenant-on-kubernetes.html#minio-k8s-upgrade-minio-tenant"><span class="std std-ref">Upgrade a MinIO Tenant</span></a> for a procedure on upgrading MinIO Tenants.</p>
</li>
<li><p>Verify the existing Operator installation.
Use <code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">get</span> <span class="pre">all</span> <span class="pre">-n</span> <span class="pre">minio-operator</span></code> to verify the health and status of all Operator pods and services.</p>
<p>If you installed the Operator to a custom namespace, specify that namespace as <code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">&lt;NAMESPACE&gt;</span></code>.</p>
<p>You can verify the currently installed Operator version by retrieving the object specification for an operator pod in the namespace.
The following example uses the <code class="docutils literal notranslate"><span class="pre">jq</span></code> tool to filter the necessary information from <code class="docutils literal notranslate"><span class="pre">kubectl</span></code>:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>get<span class="w"> </span>pod<span class="w"> </span>-l<span class="w"> </span><span class="s1">&#39;name=minio-operator&#39;</span><span class="w"> </span>-n<span class="w"> </span>minio-operator<span class="w"> </span>-o<span class="w"> </span>json<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span><span class="s1">&#39;.items[0].spec.containers&#39;</span>
</pre></div>
</div>
<p>The output resembles the following:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;env&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">         </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CLUSTER_DOMAIN&quot;</span><span class="p">,</span>
<span class="w">         </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cluster.local&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">],</span>
<span class="hll"><span class="w">   </span><span class="nt">&quot;image&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;minio/operator:v5.0.x&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">   </span><span class="nt">&quot;imagePullPolicy&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IfNotPresent&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">   </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;minio-operator&quot;</span>
</span><span class="p">}</span>
</pre></div>
</div>
<p>If your local host does not have the <code class="docutils literal notranslate"><span class="pre">jq</span></code> utility installed, you can run the first part of the command and locate the <code class="docutils literal notranslate"><span class="pre">spec.containers</span></code> section of the output.</p>
</li>
<li><p>Upgrade Operator with Kustomize</p>
<p>The following command upgrades Operator to version 5.0.15:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>apply<span class="w"> </span>-k<span class="w"> </span>github.com/minio/operator/?ref<span class="o">=</span>v5.0.15
</pre></div>
</div>
<p>In the sample output below, <code class="docutils literal notranslate"><span class="pre">configured</span></code> at the end of the line indicates where a new change was applied from the updated CRD:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>namespace/minio-operator<span class="w"> </span>configured
customresourcedefinition.apiextensions.k8s.io/miniojobs.job.min.io<span class="w"> </span>configured
customresourcedefinition.apiextensions.k8s.io/policybindings.sts.min.io<span class="w"> </span>configured
customresourcedefinition.apiextensions.k8s.io/tenants.minio.min.io<span class="w"> </span>configured
serviceaccount/console-sa<span class="w"> </span>unchanged
serviceaccount/minio-operator<span class="w"> </span>unchanged
clusterrole.rbac.authorization.k8s.io/console-sa-role<span class="w"> </span>unchanged
clusterrole.rbac.authorization.k8s.io/minio-operator-role<span class="w"> </span>unchanged
clusterrolebinding.rbac.authorization.k8s.io/console-sa-binding<span class="w"> </span>unchanged
clusterrolebinding.rbac.authorization.k8s.io/minio-operator-binding<span class="w"> </span>unchanged
configmap/console-env<span class="w"> </span>unchanged
secret/console-sa-secret<span class="w"> </span>configured
service/console<span class="w"> </span>unchanged
service/operator<span class="w"> </span>unchanged
service/sts<span class="w"> </span>unchanged
deployment.apps/console<span class="w"> </span>configured
deployment.apps/minio-operator<span class="w"> </span>configured
</pre></div>
</div>
</li>
<li><p>Validate the Operator upgrade</p>
<p>You can check the new Operator version with the same <code class="docutils literal notranslate"><span class="pre">kubectl</span></code> command used previously:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>get<span class="w"> </span>pod<span class="w"> </span>-l<span class="w"> </span><span class="s1">&#39;name=minio-operator&#39;</span><span class="w"> </span>-n<span class="w"> </span>minio-operator<span class="w"> </span>-o<span class="w"> </span>json<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span><span class="s1">&#39;.items[0].spec.containers&#39;</span>
</pre></div>
</div>
</li>
</ol>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-1">
Upgrade using Helm</label><div class="sd-tab-content docutils">
<p>The following procedure upgrades an existing MinIO Operator Installation using Helm.</p>
<p>If you installed the Operator using Kustomize, use the <span class="guilabel">Upgrade using Kustomize</span> instructions instead.</p>
<ol class="arabic">
<li><p><em>(Optional)</em> Update each MinIO Tenant to the latest stable MinIO Version.</p>
<p>Upgrading MinIO regularly ensures your Tenants have the latest features and performance improvements.
Test upgrades in a lower environment such as a Dev or QA Tenant, before applying to your production Tenants.
See <a class="reference internal" href="k8s-upgrade-minio-tenant-on-kubernetes.html#minio-k8s-upgrade-minio-tenant"><span class="std std-ref">Upgrade a MinIO Tenant</span></a> for a procedure on upgrading MinIO Tenants.</p>
</li>
<li><p>Verify the existing Operator installation.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">get</span> <span class="pre">all</span> <span class="pre">-n</span> <span class="pre">minio-operator</span></code> to verify the health and status of all Operator pods and services.</p>
<p>If you installed the Operator to a custom namespace, specify that namespace as <code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">&lt;NAMESPACE&gt;</span></code>.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">list</span></code> command to view the installed charts in the namespace:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>helm<span class="w"> </span>list<span class="w"> </span>-n<span class="w"> </span>minio-operator
</pre></div>
</div>
<p>The result should resemble the following:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>NAME<span class="w">            </span>NAMESPACE<span class="w">       </span>REVISION<span class="w">        </span>UPDATED<span class="w">                                 </span>STATUS<span class="w">          </span>CHART<span class="w">           </span>APP<span class="w"> </span>VERSION
operator<span class="w">        </span>minio-operator<span class="w">  </span><span class="m">1</span><span class="w">               </span><span class="m">2023</span>-11-01<span class="w"> </span><span class="m">15</span>:49:54.539724775<span class="w"> </span>-0400<span class="w"> </span>EDT<span class="w"> </span>deployed<span class="w">        </span>operator-5.0.x<span class="w"> </span>v5.0.x
</pre></div>
</div>
<p>You can also introspect the operator pods directly to determine the installed version.
The following example uses the <code class="docutils literal notranslate"><span class="pre">jq</span></code> tool to filter the necessary information from <code class="docutils literal notranslate"><span class="pre">kubectl</span></code>:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>get<span class="w"> </span>pod<span class="w"> </span>-l<span class="w"> </span><span class="s1">&#39;name=minio-operator&#39;</span><span class="w"> </span>-n<span class="w"> </span>minio-operator<span class="w"> </span>-o<span class="w"> </span>json<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span><span class="s1">&#39;.items[0].spec.containers&#39;</span>
</pre></div>
</div>
<p>The output resembles the following:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;env&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">         </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CLUSTER_DOMAIN&quot;</span><span class="p">,</span>
<span class="w">         </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cluster.local&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">],</span>
<span class="hll"><span class="w">   </span><span class="nt">&quot;image&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;minio/operator:v5.0.x&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">   </span><span class="nt">&quot;imagePullPolicy&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IfNotPresent&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">   </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;minio-operator&quot;</span>
</span><span class="p">}</span>
</pre></div>
</div>
<p>If your local host does not have the <code class="docutils literal notranslate"><span class="pre">jq</span></code> utility installed, you can run the first part of the command and locate the <code class="docutils literal notranslate"><span class="pre">spec.containers</span></code> section of the output.</p>
</li>
<li><p>Update the Operator Repository</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">repo</span> <span class="pre">update</span> <span class="pre">minio-operator</span></code> to update the MinIO Operator repo.
If you set a different alias for the MinIO Operator repository, specify that in the command instead of <code class="docutils literal notranslate"><span class="pre">minio-operator</span></code>.
You can use <code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">repo</span> <span class="pre">list</span></code> to review your installed repositories.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">search</span></code> to check the latest available chart version after updating the Operator Repo:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>helm<span class="w"> </span>search<span class="w"> </span>repo<span class="w"> </span>minio-operator
</pre></div>
</div>
<p>The response should resemble the following:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>NAME<span class="w">                            </span>CHART<span class="w"> </span>VERSION<span class="w">   </span>APP<span class="w"> </span>VERSION<span class="w">     </span>DESCRIPTION
minio-operator/minio-operator<span class="w">   </span><span class="m">4</span>.3.7<span class="w">           </span>v4.3.7<span class="w">          </span>A<span class="w"> </span>Helm<span class="w"> </span>chart<span class="w"> </span><span class="k">for</span><span class="w"> </span>MinIO<span class="w"> </span>Operator
minio-operator/operator<span class="w">         </span><span class="m">5</span>.0.18<span class="w">          </span>v5.0.18<span class="w">         </span>A<span class="w"> </span>Helm<span class="w"> </span>chart<span class="w"> </span><span class="k">for</span><span class="w"> </span>MinIO<span class="w"> </span>Operator
minio-operator/tenant<span class="w">           </span><span class="m">5</span>.0.18<span class="w">          </span>v5.0.18<span class="w">         </span>A<span class="w"> </span>Helm<span class="w"> </span>chart<span class="w"> </span><span class="k">for</span><span class="w"> </span>MinIO<span class="w"> </span>Operator
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">minio-operator/minio-operator</span></code> is a legacy chart and should <strong>not</strong> be installed under normal circumstances.</p>
</li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">upgrade</span></code></p>
<p>Helm uses the latest chart to upgrade the MinIO Operator:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>helm<span class="w"> </span>upgrade<span class="w"> </span>-n<span class="w"> </span>minio-operator<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>operator<span class="w"> </span>minio-operator/operator
</pre></div>
</div>
<p>If you installed the MinIO Operator to a different namespace, specify that in the <code class="docutils literal notranslate"><span class="pre">-n</span></code> argument.</p>
<p>If you used a different installation name from <code class="docutils literal notranslate"><span class="pre">operator</span></code>, replace the value above with the installation name.</p>
<p>The command results should return success with a bump in the <code class="docutils literal notranslate"><span class="pre">REVISION</span></code> value.</p>
</li>
<li><p>Validate the Operator upgrade</p>
<p>You can check the new Operator version with the same <code class="docutils literal notranslate"><span class="pre">kubectl</span></code> command used previously:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>get<span class="w"> </span>pod<span class="w"> </span>-l<span class="w"> </span><span class="s1">&#39;name=minio-operator&#39;</span><span class="w"> </span>-n<span class="w"> </span>minio-operator<span class="w"> </span>-o<span class="w"> </span>json<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span><span class="s1">&#39;.items[0].spec.containers&#39;</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
</section>
</section>
<section id="upgrade-minio-operator-4-2-3-through-4-5-7-to-4-5-8">
<span id="minio-k8s-upgrade-minio-operator-to-4-5-8"></span><h2><a class="toc-backref" href="#id7" role="doc-backlink">Upgrade MinIO Operator 4.2.3 through 4.5.7 to 4.5.8</a><a class="headerlink" href="#upgrade-minio-operator-4-2-3-through-4-5-7-to-4-5-8" title="Permalink to this heading"></a></h2>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading"></a></h3>
<p>This procedure requires the following:</p>
<ul class="simple">
<li><p>You have an existing MinIO Operator deployment running 4.2.3 through 4.5.7</p></li>
<li><p>Your Kubernetes cluster runs 1.19.0 or later</p></li>
<li><p>Your local host has <code class="docutils literal notranslate"><span class="pre">kubectl</span></code> installed and configured with access to the Kubernetes cluster</p></li>
</ul>
</section>
<section id="id1">
<h3>Procedure<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<p>This procedure upgrades MinIO Operator release 4.2.3 through 4.5.7 to release 4.5.8.
You can then upgrade from release 4.5.8 to 5.0.15.</p>
<ol class="arabic">
<li><p><em>(Optional)</em> Update each MinIO Tenant to the latest stable MinIO Version.</p>
<p>Upgrading MinIO regularly ensures your Tenants have the latest features and performance improvements.</p>
<p>Test upgrades in a lower environment such as a Dev or QA Tenant, before applying to your production Tenants.</p>
<p>See <a class="reference internal" href="k8s-upgrade-minio-tenant-on-kubernetes.html#minio-k8s-upgrade-minio-tenant"><span class="std std-ref">Upgrade a MinIO Tenant</span></a> for a procedure on upgrading MinIO Tenants.</p>
</li>
<li><p>Verify the existing Operator installation.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">get</span> <span class="pre">all</span> <span class="pre">-n</span> <span class="pre">minio-operator</span></code> to verify the health and status of all Operator pods and services.</p>
<p>If you installed the Operator to a custom namespace, specify that namespace as <code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">&lt;NAMESPACE&gt;</span></code>.</p>
<p>You can verify the currently installed Operator version by retrieving the object specification for an operator pod in the namespace.
The following example uses the <code class="docutils literal notranslate"><span class="pre">jq</span></code> tool to filter the necessary information from <code class="docutils literal notranslate"><span class="pre">kubectl</span></code>:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>get<span class="w"> </span>pod<span class="w"> </span>-l<span class="w"> </span><span class="s1">&#39;name=minio-operator&#39;</span><span class="w"> </span>-n<span class="w"> </span>minio-operator<span class="w"> </span>-o<span class="w"> </span>json<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span><span class="s1">&#39;.items[0].spec.containers&#39;</span>
</pre></div>
</div>
<p>The output resembles the following:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;env&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">         </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CLUSTER_DOMAIN&quot;</span><span class="p">,</span>
<span class="w">         </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cluster.local&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">],</span>
<span class="hll"><span class="w">   </span><span class="nt">&quot;image&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;minio/operator:v4.5.1&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">   </span><span class="nt">&quot;imagePullPolicy&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IfNotPresent&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">   </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;minio-operator&quot;</span>
</span><span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Download the Latest Stable Version of the MinIO Kubernetes Plugin</p>
<p>You can install the MinIO plugin using either the Kubernetes Krew plugin manager or manually by downloading and installing the plugin binary to your local host:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-2" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-2">
Krew Plugin Manager</label><div class="sd-tab-content docutils">
<p>Krew is a <code class="docutils literal notranslate"><span class="pre">kubectl</span></code> plugin manager developed by the <a class="reference external" href="https://github.com/kubernetes-sigs">Kubernetes SIG CLI group</a>.
See the <code class="docutils literal notranslate"><span class="pre">krew</span></code> <a class="reference external" href="https://krew.sigs.k8s.io/docs/user-guide/setup/install/">installation documentation</a> for specific instructions.
You can use the Krew plugin for Linux, macOS, and Windows operating systems.</p>
<p>You can use Krew to install the MinIO <code class="docutils literal notranslate"><span class="pre">kubectl</span></code> plugin using the following commands:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>krew<span class="w"> </span>update
kubectl<span class="w"> </span>krew<span class="w"> </span>install<span class="w"> </span>minio
</pre></div>
</div>
<p>If you want to update the MinIO plugin with Krew, use the following command:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>krew<span class="w"> </span>upgrade<span class="w"> </span>minio
</pre></div>
</div>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-3">
Manual (Linux, MacOS)</label><div class="sd-tab-content docutils">
<p>You can download the MinIO <code class="docutils literal notranslate"><span class="pre">kubectl</span></code> plugin to your local system path.
The <code class="docutils literal notranslate"><span class="pre">kubectl</span></code> CLI automatically discovers and runs compatible plugins.</p>
<p>The following code downloads the most recent version of the MinIO Kubernetes plugin and installs it to the system path:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>https://github.com/minio/operator/releases/download/v5.0.14/kubectl-minio_5.0.14_linux_amd64<span class="w"> </span>-o<span class="w"> </span>kubectl-minio
chmod<span class="w"> </span>+x<span class="w"> </span>kubectl-minio
mv<span class="w"> </span>kubectl-minio<span class="w"> </span>/usr/local/bin/
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">mv</span></code> command above may require <code class="docutils literal notranslate"><span class="pre">sudo</span></code> escalation depending on the permissions of the authenticated user.</p>
<p>Run the following command to verify installation of the plugin:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>minio<span class="w"> </span>version
</pre></div>
</div>
<p>The output should display the Operator version as 5.0.14.</p>
</div>
<input id="sd-tab-item-4" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-4">
Manual (Windows)</label><div class="sd-tab-content docutils">
<p>You can download the MinIO <code class="docutils literal notranslate"><span class="pre">kubectl</span></code> plugin to your local system path.
The <code class="docutils literal notranslate"><span class="pre">kubectl</span></code> CLI automatically discovers and runs compatible plugins.</p>
<p>The following PowerShell command downloads the most recent version of the MinIO Kubernetes plugin and installs it to the system path:</p>
<div class="copyable highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-WebRequest</span> <span class="n">-Uri</span> <span class="s2">&quot;https://github.com/minio/operator/releases/download/v5.0.14/kubectl-minio_5.0.14_windows_amd64.exe&quot;</span> <span class="n">-OutFile</span> <span class="s2">&quot;C:\kubectl-plugins\kubectl-minio.exe&quot;</span>
</pre></div>
</div>
<p>Ensure the path to the plugin folder is included in the Windows PATH.</p>
<p>Run the following command to verify installation of the plugin:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>minio<span class="w"> </span>version
</pre></div>
</div>
<p>The output should display the Operator version as 5.0.14.</p>
</div>
</div>
</li>
<li><p>Run the initialization command to upgrade the Operator</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">minio</span> <span class="pre">init</span></code> command to upgrade the existing MinIO Operator installation</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>minio<span class="w"> </span>init
</pre></div>
</div>
</li>
<li><p>Validate the Operator upgrade</p>
<p>You can check the Operator version by reviewing the object specification for an Operator Pod using a previous step.</p>
</li>
</ol>
</section>
</section>
<section id="upgrade-minio-operator-4-0-0-through-4-2-2-to-4-2-3">
<span id="minio-k8s-upgrade-minio-operator-4-2-2-procedure"></span><h2><a class="toc-backref" href="#id8" role="doc-backlink">Upgrade MinIO Operator 4.0.0 through 4.2.2 to 4.2.3</a><a class="headerlink" href="#upgrade-minio-operator-4-0-0-through-4-2-2-to-4-2-3" title="Permalink to this heading"></a></h2>
<section id="id2">
<h3>Prerequisites<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<p>This procedure assumes that:</p>
<ul class="simple">
<li><p>You have an existing MinIO Operator deployment running any release from 4.0.0 through 4.2.2</p></li>
<li><p>Your Kubernetes cluster runs 1.19.0 or later</p></li>
<li><p>Your local host has <code class="docutils literal notranslate"><span class="pre">kubectl</span></code> installed and configured with access to the Kubernetes cluster</p></li>
</ul>
</section>
<section id="id3">
<h3>Procedure<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<p>This procedure covers the necessary steps to upgrade a MinIO Operator deployment running any release from 4.0.0 through 4.2.2 to 4.2.3.
You can then perform <a class="reference internal" href="k8s-upgrade-minio-operator-kubernetes.html#minio-k8s-upgrade-minio-operator-procedure"><span class="std std-ref">Upgrade MinIO Operator 5.0.15 to 5.0.18</span></a> to complete the upgrade to 5.0.18.</p>
<p>There is no direct upgrade path for 4.0.0 - 4.2.2 installations to 5.0.18.</p>
<ol class="arabic">
<li><p><em>(Optional)</em> Update each MinIO Tenant to the latest stable MinIO Version.</p>
<p>Upgrading MinIO regularly ensures your Tenants have the latest features and performance improvements.
Test upgrades in a lower environment such as a Dev or QA Tenant, before applying to your production Tenants.</p>
<p>See <a class="reference internal" href="k8s-upgrade-minio-tenant-on-kubernetes.html#minio-k8s-upgrade-minio-tenant"><span class="std std-ref">Upgrade a MinIO Tenant</span></a> for a procedure on upgrading MinIO Tenants.</p>
</li>
<li><p>Check the Security Context for each Tenant Pool</p>
<p>Use the following command to validate the specification for each managed MinIO Tenant:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>get<span class="w"> </span>tenants<span class="w"> </span>&lt;TENANT-NAME&gt;<span class="w"> </span>-n<span class="w"> </span>&lt;TENANT-NAMESPACE&gt;<span class="w"> </span>-o<span class="w"> </span>yaml
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">spec.pools.securityContext</span></code> field does not exist for a Tenant, the tenant pods likely run as root.</p>
<p>As part of the 4.2.3 and later series, pods run with a limited permission set enforced as part of the Operator upgrade.
However, Tenants running pods as root may fail to start due to the security context mismatch.
You can set an explicit Security Context that allows pods to run as root for those Tenants:</p>
<div class="copyable highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">  </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">  </span><span class="nt">runAsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">  </span><span class="nt">runAsNonRoot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">fsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
</pre></div>
</div>
<p>You can use the following command to edit the tenant and apply the changes:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>edit<span class="w"> </span>tenants<span class="w"> </span>&lt;TENANT-NAME&gt;<span class="w"> </span>-n<span class="w"> </span>&lt;TENANT-NAMESPACE&gt;
<span class="c1"># Modify the securityContext as needed</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://kubernetes.io/docs/concepts/security/pod-security-standards/">Pod Security Standards</a> for more information on Kubernetes Security Contexts.</p>
</li>
<li><p>Upgrade to Operator 4.2.3</p>
<p>Download the MinIO Kubernetes Plugin 4.2.3 and use it to upgrade the Operator.
Open <a class="reference external" href="https://github.com/minio/operator/releases/tag/v4.2.3">https://github.com/minio/operator/releases/tag/v4.2.3</a> in a browser and download the binary that corresponds to your local host OS.</p>
<p>For example, Linux hosts running an Intel or AMD processor can run the following commands:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://github.com/minio/operator/releases/download/v4.2.3/kubectl-minio_4.2.3_linux_amd64<span class="w"> </span>-o<span class="w"> </span>kubectl-minio_4.2.3
chmod<span class="w"> </span>+x<span class="w"> </span>kubectl-minio_4.2.3
./kubectl-minio_4.2.3<span class="w"> </span>init
</pre></div>
</div>
</li>
<li><p>Validate all Tenants and Operator pods</p>
<p>Check the Operator and MinIO Tenant namespaces to ensure all pods and services started successfully.</p>
<p>For example:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>get<span class="w"> </span>all<span class="w"> </span>-n<span class="w"> </span>minio-operator
kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-l<span class="w"> </span><span class="s2">&quot;v1.min.io/tenant&quot;</span><span class="w"> </span>--all-namespaces
</pre></div>
</div>
</li>
<li><p>Upgrade to 5.0.18</p>
<p>Follow the <a class="reference internal" href="k8s-upgrade-minio-operator-kubernetes.html#minio-k8s-upgrade-minio-operator-procedure"><span class="std std-ref">Upgrade MinIO Operator 5.0.15 to 5.0.18</span></a> procedure to upgrade to the latest stable Operator version.</p>
</li>
</ol>
</section>
</section>
<section id="upgrade-minio-operator-3-0-0-through-3-0-29-to-4-2-2">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Upgrade MinIO Operator 3.0.0 through 3.0.29 to 4.2.2</a><a class="headerlink" href="#upgrade-minio-operator-3-0-0-through-3-0-29-to-4-2-2" title="Permalink to this heading"></a></h2>
<section id="id4">
<h3>Prerequisites<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h3>
<p>This procedure assumes that:</p>
<ul class="simple">
<li><p>You have an existing MinIO Operator deployment running 3.X.X</p></li>
<li><p>Your Kubernetes cluster runs 1.19.0 or later</p></li>
<li><p>Your local host has <code class="docutils literal notranslate"><span class="pre">kubectl</span></code> installed and configured with access to the Kubernetes cluster</p></li>
</ul>
</section>
<section id="id5">
<h3>Procedure<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h3>
<p>This procedure covers the necessary steps to upgrade a MinIO Operator deployment running any release from 3.0.0 through 3.2.9 to 4.2.2.
You can then perform <a class="reference internal" href="#minio-k8s-upgrade-minio-operator-4-2-2-procedure"><span class="std std-ref">Upgrade MinIO Operator 4.0.0 through 4.2.2 to 4.2.3</span></a>, followed by <a class="reference internal" href="k8s-upgrade-minio-operator-kubernetes.html#minio-k8s-upgrade-minio-operator-procedure"><span class="std std-ref">Upgrade MinIO Operator 5.0.15 to 5.0.18</span></a>.</p>
<p>There is no direct upgrade path from a 3.X.X series installation to 5.0.18.</p>
<ol class="arabic">
<li><p>(Optional) Update each MinIO Tenant to the latest stable MinIO Version.</p>
<p>Upgrading MinIO regularly ensures your Tenants have the latest features and performance improvements.</p>
<p>Test upgrades in a lower environment such as a Dev or QA Tenant, before applying to your production Tenants.</p>
<p>See <a class="reference internal" href="k8s-upgrade-minio-tenant-on-kubernetes.html#minio-k8s-upgrade-minio-tenant"><span class="std std-ref">Upgrade a MinIO Tenant</span></a> for a procedure on upgrading MinIO Tenants.</p>
</li>
<li><p>Validate the Tenant <code class="docutils literal notranslate"><span class="pre">tenant.spec.zones</span></code> values</p>
<p>Use the following command to validate the specification for each managed MinIO Tenant:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>get<span class="w"> </span>tenants<span class="w"> </span>&lt;TENANT-NAME&gt;<span class="w"> </span>-n<span class="w"> </span>&lt;TENANT-NAMESPACE&gt;<span class="w"> </span>-o<span class="w"> </span>yaml
</pre></div>
</div>
<ul class="simple">
<li><p>Ensure each <code class="docutils literal notranslate"><span class="pre">tenant.spec.zones</span></code> element has a <code class="docutils literal notranslate"><span class="pre">name</span></code> field set to the name for that zone.
Each zone must have a unique name for that Tenant, such as <code class="docutils literal notranslate"><span class="pre">zone-0</span></code> and <code class="docutils literal notranslate"><span class="pre">zone-1</span></code> for the first and second zones respectively.</p></li>
<li><p>Ensure each <code class="docutils literal notranslate"><span class="pre">tenant.spec.zones</span></code> has an explicit <code class="docutils literal notranslate"><span class="pre">securityContext</span></code> describing the permission set with which pods run in the cluster.</p></li>
</ul>
<p>The following example tenant YAML fragment sets the specified fields:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;minio/minio:$(LATEST-VERSION)&quot;</span>
<span class="nn">...</span>
<span class="nt">zones</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">servers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;zone-0&quot;</span>
<span class="w">  </span><span class="nt">volumesPerServer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">  </span><span class="nt">volumeClaimTemplate</span><span class="p">:</span>
<span class="w">     </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">     </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data</span>
<span class="w">     </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">     </span><span class="nt">accessModes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
<span class="w">     </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">        </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">           </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1Ti</span>
<span class="w">  </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">     </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">     </span><span class="nt">runAsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">     </span><span class="nt">runAsNonRoot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">     </span><span class="nt">fsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">servers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;zone-1&quot;</span>
<span class="w">  </span><span class="nt">volumesPerServer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">  </span><span class="nt">volumeClaimTemplate</span><span class="p">:</span>
<span class="w">     </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">     </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data</span>
<span class="w">     </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">     </span><span class="nt">accessModes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
<span class="w">     </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">        </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">           </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1Ti</span>
<span class="w">  </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">     </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">     </span><span class="nt">runAsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">     </span><span class="nt">runAsNonRoot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">     </span><span class="nt">fsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
</pre></div>
</div>
<p>You can use the following command to edit the tenant and apply the changes:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>edit<span class="w"> </span>tenants<span class="w"> </span>&lt;TENANT-NAME&gt;<span class="w"> </span>-n<span class="w"> </span>&lt;TENANT-NAMESPACE&gt;
</pre></div>
</div>
</li>
<li><p>Upgrade to Operator 4.2.2</p>
<p>Download the MinIO Kubernetes Plugin 4.2.2 and use it to upgrade the Operator.
Open <a class="reference external" href="https://github.com/minio/operator/releases/tag/v4.2.2">https://github.com/minio/operator/releases/tag/v4.2.2</a> in a browser and download the binary that corresponds to your local host OS.
For example, Linux hosts running an Intel or AMD processor can run the following commands:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://github.com/minio/operator/releases/download/v4.2.3/kubectl-minio_4.2.2_linux_amd64<span class="w"> </span>-o<span class="w"> </span>kubectl-minio_4.2.2
chmod<span class="w"> </span>+x<span class="w"> </span>kubectl-minio_4.2.2

./kubectl-minio_4.2.2<span class="w"> </span>init
</pre></div>
</div>
</li>
<li><p>Validate all Tenants and Operator pods</p>
<p>Check the Operator and MinIO Tenant namespaces to ensure all pods and services started successfully.</p>
<p>For example:</p>
<div class="copyable highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>get<span class="w"> </span>all<span class="w"> </span>-n<span class="w"> </span>minio-operator

kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-l<span class="w"> </span><span class="s2">&quot;v1.min.io/tenant&quot;</span><span class="w"> </span>--all-namespaces
</pre></div>
</div>
</li>
<li><p>Upgrade to 4.2.3</p>
<p>Follow the <a class="reference internal" href="#minio-k8s-upgrade-minio-operator-4-2-2-procedure"><span class="std std-ref">Upgrade MinIO Operator 4.0.0 through 4.2.2 to 4.2.3</span></a> procedure to upgrade to Operator 4.2.3.
You can then upgrade to 5.0.18.</p>
</li>
</ol>
</section>
</section>
</section>


            </div><div class="footer">
   This work is licensed under a
   <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License.</a>
   2020-Present, MinIO, Inc. 
   <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
      <img height="10" alt="Creative Commons License" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
   </a>
</div>
         </div>
      </div>
   </section><div id="cookie">
    <div class="container">
        <div class="cookie__text">
            <strong>Your privacy is important to us:</strong>
            We use cookies in order to give you a better experience. If you wish so, you can always review our 
            <a target="_blank" rel="noreferrer noopener" href="https://min.io/privacy-policy">Privacy Policy</a>.
        </div>

        <button type="button" id="cookie__btn">Accept</button>
    </div>
</div><script>
    // Dark mode and read mode detection

    // Dark mode
    /*var isDarkMode = localStorage.getItem("dark-mode");
    var dmToggleBtn = document.getElementById("dark-mode-toggle");
    if (isDarkMode === "true") {
       document.documentElement.classList.add("dark-mode");
       dmToggleBtn.classList.add("active");
    }

    // Read mode
    var isReadMode = localStorage.getItem("read-mode");
    var rmToggleBtn = document.getElementById("read-mode-toggle");

    if (isReadMode === "true") {
        document.documentElement.classList.add("read-mode");
        rmToggleBtn.classList.add("active");
    }*/
 </script>
  </body>
</html>